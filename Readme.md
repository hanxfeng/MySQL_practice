# 项目简介  

这是我用来练习MySQL知识的练习项目，同时通过这个项目学习了后端知识。

前端是使用AI制作，不过多介绍。  

# 后端与数据库介绍  

## 数据库介绍  

### 表名：users

表作用：存储系统用户的基础信息，包括学生和老师的账号、身份、资产等核心数据，是整个系统的用户基础表。

#### id：

用户唯一标识，作为主键自增，用于区分不同用户。

#### username：

用户登录使用的用户名，具有唯一性且非空，保证每个用户的登录名不重复。

#### password：

用户登录的密码，非空存储，通常会存储加密后的密码串。

#### email：

用户绑定的邮箱地址，具有唯一性，可用于密码找回、消息通知等场景。

#### phone：

用户绑定的手机号码，具有唯一性，可用于登录验证、短信通知等场景。

#### role：

用户角色标识，默认值为0（代表学生），1代表老师，用于区分用户的身份权限。

#### balance：

用户的账户余额，总长度10位（含2位小数），默认值0.00，学生可用于支付课程费用。

#### created\_at：

用户的注册时间，默认值为当前时间戳，记录用户创建账号的时间。



---



\### 表名：courses

\*\*表作用\*\*：存储课程的基础信息，包括课程名称、价格、授课老师、人气数据等，是课程体系的核心表。

\#### id：

课程唯一标识，作为主键自增，用于区分不同课程。

\#### title：

课程名称，非空约束，是课程的核心标识之一。

\#### description：

课程的详细描述，使用文本类型存储，可记录课程的介绍、大纲等内容。

\#### cover\_url：

课程封面图片的网络地址，用于展示课程的封面。

\#### price：

课程的售价，总长度10位（含2位小数），默认值0.00，是学生购买课程的价格依据。

\#### teacher\_id：

授课老师的用户ID，非空约束，关联users表的id，用于绑定课程的授课老师。

\#### student\_count：

课程的学生数量，默认值0，用于统计选学该课程的学生人数。

\#### likes：

课程的点赞数，默认值0，用于统计课程的受欢迎程度。

\#### created\_at：

课程的创建时间，默认值为当前时间戳，记录课程的创建时间。



---



\### 表名：lessons

\*\*表作用\*\*：存储课程的章节/课时信息，是课程内容的细分表，关联到具体课程。

\#### id：

章节唯一标识，作为主键自增，用于区分不同章节。

\#### course\_id：

所属课程的ID，非空约束，关联courses表的id，用于绑定章节到具体课程。

\#### title：

章节的标题，非空约束，是章节的核心标识。

\#### video\_url：

章节的视频资源网络地址，用于播放章节的视频内容。

\#### duration：

章节视频的时长，单位为秒，记录视频的播放时长。

\#### sort\_order：

章节的排序顺序，默认值0，用于控制课程内章节的展示顺序。



---



\### 表名：course\_student

\*\*表作用\*\*：存储学生的选课记录，是用户与课程的关联表，实现学生选学课程的多对多关系。

\#### user\_id：

学生的用户ID，关联users表的id，用于标识选课的学生。

\#### course\_id：

课程的ID，关联courses表的id，用于标识被选的课程。

\#### created\_at：

选课的时间，默认值为当前时间戳，记录学生选课的时间。



---



\### 表名：orders

\*\*表作用\*\*：存储学生购买课程的订单信息，记录订单的金额、状态、支付时间等关键数据。

\#### id：

订单唯一标识，作为主键自增，用于区分不同订单。

\#### user\_id：

下单学生的用户ID，非空约束，关联users表的id，用于标识下单用户。

\#### course\_id：

订单对应的课程ID，非空约束，关联courses表的id，用于标识订单对应的课程。

\#### amount：

订单的金额，总长度10位（含2位小数），非空约束，记录订单的支付金额。

\#### status：

订单的状态，默认值0（未支付），1代表已支付，2代表已退款，用于标识订单的处理状态。

\#### paid\_at：

订单的支付时间，记录用户完成支付的具体时间。

\#### created\_at：

订单的创建时间，默认值为当前时间戳，记录订单的生成时间。



---



\### 表名：learning\_progress

\*\*表作用\*\*：存储学生对单个章节的学习进度，记录学生在每个章节的学习完成情况。

\#### user\_id：

学生的用户ID，关联users表的id，用于标识学习的学生。

\#### lesson\_id：

章节的ID，关联lessons表的id，用于标识对应的章节。

\#### progress：

章节的学习进度，默认值0，可记录进度百分比或播放时长占比等。

\#### updated\_at：

进度的更新时间，默认值为当前时间戳，记录进度最后更新的时间。



---



\### 表名：comments

\*\*表作用\*\*：存储学生对课程的评论和评分信息，是课程反馈的核心表。

\#### id：

评论唯一标识，作为主键自增，用于区分不同评论。

\#### user\_id：

评论用户的ID，非空约束，关联users表的id，用于标识评论的用户。

\#### course\_id：

评论对应的课程ID，非空约束，关联courses表的id，用于标识评论的课程。

\#### rating：

用户对课程的评分，取值范围为1-5，用于量化课程的评价。

\#### content：

评论的具体内容，使用文本类型存储，记录用户的文字反馈。

\#### likes：

评论的点赞数，默认值0，用于统计评论的受欢迎程度。

\#### created\_at：

评论的创建时间，默认值为当前时间戳，记录评论的发布时间。



---



\### 表名：exams

\*\*表作用\*\*：存储课程对应的考试信息，记录考试的归属课程和标题等基础数据。

\#### id：

考试唯一标识，作为主键自增，用于区分不同考试。

\#### course\_id：

考试所属的课程ID，非空约束，关联courses表的id，用于绑定考试到具体课程。

\#### title：

考试的标题，用于标识考试的主题或范围。

\#### created\_at：

考试的创建时间，默认值为当前时间戳，记录考试的创建时间。



---



\### 表名：exam\_results

\*\*表作用\*\*：存储学生参加考试的成绩信息，记录学生在各考试中的得分情况。

\#### exam\_id：

考试的ID，关联exams表的id，用于标识对应的考试。

\#### user\_id：

学生的用户ID，关联users表的id，用于标识参加考试的学生。

\#### course\_id：

考试所属的课程ID，非空约束，关联courses表的id，用于绑定成绩到具体课程。

\#### score：

学生的考试分数，记录学生在该考试中的得分。

\#### created\_at：

成绩的创建时间，默认值为当前时间戳，记录学生完成考试的时间。



---



\### 表名：favorites

\*\*表作用\*\*：存储学生的课程收藏记录，实现学生收藏课程的功能。

\#### id：

收藏记录唯一标识，作为主键自增，用于区分不同收藏记录。

\#### user\_id：

收藏用户的ID，非空约束，关联users表的id，用于标识收藏的学生。

\#### course\_id：

被收藏的课程ID，非空约束，关联courses表的id，用于标识被收藏的课程。

\#### created\_at：

收藏的时间，默认值为当前时间戳，记录学生收藏课程的时间。



---



\### 表名：comment\_likes

\*\*表作用\*\*：存储用户对评论的点赞记录，实现评论点赞的功能，且保证用户对同一评论只能点赞一次。

\#### id：

点赞记录唯一标识，作为主键自增，用于区分不同点赞记录。

\#### user\_id：

点赞用户的ID，非空约束，关联users表的id（用户删除时，点赞记录也删除），用于标识点赞的用户。

\#### comment\_id：

被点赞的评论ID，非空约束，关联comments表的id（评论删除时，点赞记录也删除），用于标识被点赞的评论。

\#### created\_at：

点赞的时间，默认值为当前时间戳，记录用户点赞的时间。



---



\### 表名：course\_likes

\*\*表作用\*\*：存储用户对课程的点赞记录，实现课程点赞的功能，且保证用户对同一课程只能点赞一次。

\#### id：

点赞记录唯一标识，作为主键自增，用于区分不同点赞记录。

\#### user\_id：

点赞用户的ID，非空约束，关联users表的id（用户删除时，点赞记录也删除），用于标识点赞的用户。

\#### course\_id：

被点赞的课程ID，非空约束，关联courses表的id（课程删除时，点赞记录也删除），用于标识被点赞的课程。

\#### created\_at：

点赞的时间，默认值为当前时间戳，记录用户点赞的时间。



---



\### 表名：course\_progress

\*\*表作用\*\*：存储学生对整个课程的学习进度（百分比），记录学生完成课程的整体情况。

\#### user\_id：

学生的用户ID，非空约束，关联users表的id，用于标识学习的学生。

\#### course\_id：

课程的ID，非空约束，关联courses表的id，用于标识对应的课程。

\#### progress：

课程的学习进度百分比，默认值0，记录学生完成课程的比例。

\#### updated\_at：

进度的更新时间，默认值为当前时间戳（且更新时自动刷新），记录进度最后更新的时间。



---



\### 表名：learning\_history

\*\*表作用\*\*：存储学生的学习历史记录，详细记录学生学习每个章节的开始时间、结束时间、时长等信息。

\#### id：

学习记录唯一标识，作为主键自增，用于区分不同学习记录。

\#### user\_id：

学生的用户ID，非空约束，关联users表的id，用于标识学习的学生。

\#### course\_id：

课程的ID，非空约束，关联courses表的id，用于标识对应的课程。

\#### lesson\_id：

章节的ID，非空约束，关联lessons表的id，用于标识对应的章节。

\#### start\_at：

学习的开始时间，非空约束，默认值为当前时间戳，记录学生开始学习的时间。

\#### finish\_at：

学习的结束时间，记录学生完成学习的时间。

\#### duration\_seconds：

学习的时长，单位为秒，记录学生学习该章节的耗时。

\#### created\_at：

记录的创建时间，默认值为当前时间戳，记录学习记录的生成时间。

\#### updated\_at：

记录的更新时间，默认值为当前时间戳（且更新时自动刷新），记录学习记录最后更新的时间。

\## 后端接口介绍：  

### 接口1：/api/login
#### 类型：
POST
#### 输入：
email（邮箱）、password（密码）
#### 作用：
用户登录验证，验证成功后生成并返回JWT令牌，用于后续接口的身份认证。

---

### 接口2：/api/course_list
#### 类型：
POST
#### 输入：
page（页码，默认1）、limit（每页条数，默认10）、keyword（搜索关键词）、teacher_id（老师ID）、min_price（最低价格）、max_price（最高价格）、free_only（是否仅免费课程）、sort_by（排序字段，默认created_at）、sort_order（排序方式，默认desc）
#### 作用：
根据多条件筛选、分页和排序查询课程列表，并返回课程总数、分页信息及价格/学生数范围等筛选辅助数据。

---

### 接口3：/api/course/popular
#### 类型：
POST
#### 输入：
limit（返回条数，默认10，最大50）、sort_by（排序字段，默认student_count，可选likes、recent）
#### 作用：
根据学生数、点赞数或创建时间排序，查询热门课程列表。

---

### 接口4：/api/course_detail
#### 类型：
POST
#### 输入：
course_id（课程ID，必填）
#### 作用：
查询指定课程的详细信息，包括课程基础信息、授课老师信息及课程章节列表。

---

### 接口5：/api/buy_course
#### 类型：
POST
#### 输入：
course_id（课程ID，必填）、请求头携带Authorization（Bearer Token）
#### 作用：
学生购买课程，验证用户是否已购买、余额是否充足，完成订单创建、余额扣除、课程权限添加、学习进度初始化及课程学生数更新。

---

### 接口6：/api/progress/get
#### 类型：
POST
#### 输入：
course_id（课程ID，必填）、请求头携带Authorization（Bearer Token）
#### 作用：
查询指定课程的整体学习进度（百分比）及每个章节的学习进度详情。

---

### 接口7：/api/progress/update
#### 类型：
POST
#### 输入：
lesson_id（章节ID，必填）、progress（进度值，0~100，必填）、请求头携带Authorization（Bearer Token）
#### 作用：
更新指定章节的学习进度，并同步计算和更新对应课程的整体学习进度。

---

### 接口8：/api/add_comment
#### 类型：
POST
#### 输入：
course_id（课程ID，必填）、rating（评分，1~5，必填）、content（评论内容，必填）、请求头携带Authorization（Bearer Token）
#### 作用：
学生为已购买的课程添加评论和评分，验证课程是否存在、用户是否已购买课程。

---

### 接口9：/api/get_comments
#### 类型：
POST
#### 输入：
course_id（课程ID，必填）、page（页码，默认1）、请求头携带Authorization（Bearer Token）
#### 作用：
分页查询指定课程的评论列表，包含评论内容、评分、点赞数、发布时间及评论用户名称。

---

### 接口10：/api/favorite_course
#### 类型：
POST
#### 输入：
course_id（课程ID，必填）、请求头携带Authorization（Bearer Token）
#### 作用：
用户收藏/取消收藏课程，若已收藏则删除收藏记录，未收藏则添加收藏记录。

---

### 接口11：/api/get_favorites
#### 类型：
POST
#### 输入：
page（页码，默认1）、请求头携带Authorization（Bearer Token）
#### 作用：
分页查询用户收藏的课程列表，返回课程基础信息。

---

### 接口12：/api/like_comment
#### 类型：
POST
#### 输入：
comment_id（评论ID，必填）、请求头携带Authorization（Bearer Token）
#### 作用：
用户点赞/取消点赞评论，若未点赞则添加点赞记录并增加评论点赞数，已点赞则删除记录并减少评论点赞数（最低为0）。

---

### 接口13：/api/like_course
#### 类型：
POST
#### 输入：
course_id（课程ID，必填）、请求头携带Authorization（Bearer Token）
#### 作用：
用户点赞/取消点赞课程，若未点赞则添加点赞记录并增加课程点赞数，已点赞则删除记录并减少课程点赞数（最低为0）。

---

### 接口14：/api/course_progress/get
#### 类型：
POST
#### 输入：
course_id（课程ID，必填）、请求头携带Authorization（Bearer Token）
#### 作用：
查询指定课程的整体进度及所有章节的进度详情（左连接查询，无进度则显示0）。

---

### 接口15：/api/lesson/get
#### 类型：
POST
#### 输入：
lesson_id（章节ID，必填）、请求头携带Authorization（Bearer Token）
#### 作用：
查询指定章节的详细信息，并自动创建学习历史记录（若当前无未完成的记录）。

---

### 接口16：/api/lesson/finish
#### 类型：
POST
#### 输入：
lesson_id（章节ID，必填）、请求头携带Authorization（Bearer Token）
#### 作用：
记录章节学习完成时间和学习时长，并更新对应课程的整体进度（按章节进度平均值）。

---

### 接口17：/api/user/streak
#### 类型：
GET
#### 输入：
请求头携带Authorization（Bearer Token）
#### 作用：
计算并返回用户的连续学习天数、今日是否学习及最后学习日期。

---

### 接口18：/api/learning/history
#### 类型：
GET
#### 输入：
请求头携带Authorization（Bearer Token）
#### 作用：
查询用户最近30条学习历史记录，包含课程、章节、学习时间及时长等信息。

---

### 接口19：/api/learning/today_total
#### 类型：
GET
#### 输入：
请求头携带Authorization（Bearer Token）
#### 作用：
统计用户今日的学习总时长（秒）。

---

### 接口20：/api/exam/results
#### 类型：
POST
#### 输入：
page（页码，默认1）、limit（每页条数，默认10）、请求头携带Authorization（Bearer Token）
#### 作用：
分页查询用户的考试成绩列表，返回成绩统计信息（平均分、最高分、最低分）及分页信息。

---

### 接口21：/api/course/ranking
#### 类型：
POST
#### 输入：
type（排行榜类型，默认student_count，可选likes、sales）、limit（返回条数，默认10，1~100）
#### 作用：
根据学生数、点赞数或销售额（学生数×价格）排序，返回课程排行榜。

---

### 接口22：/api/user/profile
#### 类型：
GET
#### 输入：
请求头携带Authorization（Bearer Token）
#### 作用：
查询用户的基本信息，包括用户名、邮箱、手机号、角色、余额及注册时间。

---

### 接口23：/api/user/profile/update
#### 类型：
POST
#### 输入：
update_type（修改类型，必填，可选username、email、phone）、对应修改类型的新值（如new_username）、验证信息（如旧邮箱/旧手机号）、请求头携带Authorization（Bearer Token）
#### 作用：
更新用户的用户名、邮箱或手机号，验证旧信息并检查新值是否已被占用。

---

### 接口24：/api/user/change-password
#### 类型：
POST
#### 输入：
old_password（旧密码，必填）、new_password（新密码，必填，长度≥6）、请求头携带Authorization（Bearer Token）
#### 作用：
修改用户密码，验证旧密码，检查新密码长度及是否与旧密码相同。

---

### 接口25：/api/user/learning-overview
#### 类型：
GET
#### 输入：
请求头携带Authorization（Bearer Token）
#### 作用：
返回用户的学习统计数据（总时长、学习天数、课程完成率等）、近期学习活动（今日/本周时长、最后学习信息）、课程进度分布及时间拆解数据。

---

### 接口26：/api/user/dashboard
#### 类型：
GET
#### 输入：
请求头携带Authorization（Bearer Token）
#### 作用：
返回用户的综合数据面板，包含基本信息、学习摘要、最近活动、进度概览、互动统计、成就及快速链接（继续学习、推荐课程）。

